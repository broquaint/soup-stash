<h1>Recent games <%= render 'shared/period_filter' %></h1>

<div class='games-listing'>
  <%= render 'shared/selections' %>
  <table class='table table-striped table-condensed'>
    <thead>
      <tr>
        <th><%= link_to_with 'Score', 'sort' => 'score' %></th>
        <th>Player</th>
        <th><%= render partial: 'shared/column_filter',
                locals: { column: 'Race', filterables: DCSS::RACE.values, param: 'race' }
                %>
        </th>
        <th><%= render partial: 'shared/column_filter',
                locals: { column: 'Background', filterables: DCSS::BACKGROUND.values, param: 'background' }
                %>
        </th>
        <th><%= render partial: 'shared/column_filter',
                locals: { column: 'God', filterables: DCSS::GODS, param: 'god' }
                %>
        </th>
        <th><abbr title="Experience Level">XL</abbr></th>
        <th>Killer</TH>
      </tr>
    </thead>
    <tbody>
      <% for game in @games %>
      <tr>
        <td><%= link_to number_with_delimiter(game.score), game_path(game) %>
          <% if game.won %><i class="icon-star" title="Won!"></i><% end %></td>
        <td><%= player_link(game) %> the <%= game.title %></td>
        <td><%= link_to_with game.race, 'race' => game.race %></td>
        <td><%= link_to_with game.background, 'background' => game.background %></td>
        <td><%= game.god ? link_to_with(game.god, 'god' => game.god) : '-' %></td>
        <td><%= game.xl %></td>
        <td><%= if game.killer
                  link_to_with game.killer, 'killer' => game.killer
                else
                  link_to_with game.ending_str, 'ending' => game.ending
                end %></td>
      </tr>
      <% end %>
    </tbody>
  </table>

  <%= paginate @games %>
</div>
